<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="volunteer">

	<select id="getList" resultType="VolunteerVO">
		select *
		from volunteer
	</select>
	
	<select id="getDetail" parameterType="String" resultType="VolunteerVO">
		select *
		from volunteer
		where vol_id = #{volId}
	</select>
	
	<select id="getReviewList" parameterType="String" resultType="ReviewVO">
		select *
		from review 
		where reserv_id in (select reserv_id from reservation where vol_id = #{volId})
	</select>
	
	<insert id="registerVol" parameterType="VolunteerVO">
		insert into volunteer
		values ('V'||LPAD(SEQ_VOLUNTEER.NEXTVAL, 5, '0'), #{volTitle}, #{memId}, #{startDate}, #{endDate},
		#{startTime}, #{endTime}, #{personnel}, #{total}, #{volCtId}, #{location}, #{status}, #{target},
		#{qualification}, #{detail}, #{thumbnail})
	</insert>
	
	<insert id="reservVol" parameterType="ReservationVO">
		insert into reservation
		values ('R'||LPAD(SEQ_RESERVATION.NEXTVAL, 5, '0'), #{volId}, #{memId}, #{reservDate}, #{reservTime},
		SYSDATE, null, #{rStId})
	</insert>
	
	<select id="getReservDetail" parameterType="String" resultType="ReservationVO">
		select *
		from reservation
		where reserv_id = #{reservId}
	</select>
	
	<select id="getReservList" parameterType="String" resultType="ReservationVO">
		select *
		from reservation
		where mem_id = #{memId}
	</select>
	
	<select id="getDetailForReserv" parameterType="String" resultType="VolunteerVO">
		select *
		from volunteer
		where vol_id = ( select vol_id
                         from reservation
                         where reserv_Id = #{reservId})
	</select>
	
	<update id="cancelReserv" parameterType="ReservationVO">
		update reservation
		set r_st_id = #{rStId}, cancel_date = SYSDATE
		where reserv_id = #{reservId}
	</update>
	
	<delete id="deleteVol" parameterType="String">
	
		delete from volunteer where vol_Id = #{volId}
		
	</delete>
	
	<update id="updateVol" parameterType='String'>
		update Volunteer
		set vol_title = #{volTitle}, mem_id = #{memId}, start_date = #{startDate}, end_date = #{endDate},
			start_time = #{startTime}, end_time = #{endTime}, personnel = #{personnel}, total = #{total}, 
			vol_ct_id = #{volCtId}, location = #{location}, status = #{status}, target = #{target},
			qualification = #{qualification}, detail = #{detail}, thumbnail = #{thumbnail}
		where vol_id = #{volId}
	</update>
	
</mapper>